{"name":"Wordpress on Heroku","tagline":"Deploy Wordpress to Heroku in < 60 seconds or your money back","body":"# Heroku buildpack: Wordpress on Heroku\r\n\r\n### This is a Heroku buildpack for running [Wordpress](http://wordpress.org) on [Heroku](http://heroku.com)\r\n\r\nIt uses this [Wordpress](http://github.com/mchung/wordpress-on-heroku) project template to bootstrap a highly tuned Wordpress site built on the following stack:\r\n\r\n* `nginx` - Nginx for serving web content.  Built specifically for Heroku.  [See compile options](https://github.com/mchung/heroku-buildpack-wordpress/blob/master/support/package_nginx).\r\n* `php` - PHP-FPM for process management.  [See compile options](https://github.com/mchung/heroku-buildpack-wordpress/blob/master/support/package_php).\r\n* `wordpress` - Downloaded directly [from wordpress.org](http://wordpress.org/download/release-archive/).\r\n* `MySQL` - ClearDB for the MySQL backend.\r\n* `Sendgrid` - Sendgrid for the email backend.\r\n* `MemCachier` - MemCachier for the memcached backend.\r\n\r\nYou can see a live demo at [Wordpress on Heroku](http://wordpress-on-heroku.herokuapp.com).\r\n\r\n## Getting started in 60 seconds\r\n\r\nFork and rename the [Wordpress project template](http://github.com/mchung/wordpress-on-heroku).\r\n\r\nLet's clone the repository for a new blog, 99catfacts.com\r\n```bash\r\n$ git clone git://github.com/your_name/wordpress-on-heroku.git 99catfacts.com\r\n```\r\n\r\nCreate Wordpress on Heroku.\r\n```bash\r\n$ cd 99catfacts.com\r\n$ heroku create -s cedar\r\n$ heroku config:add BUILDPACK_URL=https://github.com/mchung/heroku-buildpack-wordpress.git\r\n```\r\n\r\n> Don't have the Heroku Toolbelt installed? Follow these [quickstart instructions](https://devcenter.heroku.com/articles/quickstart). Takes about 2 minutes.\r\n\r\nDeploy your Wordpress site to Heroku.\r\n```bash\r\n$ git push heroku master\r\n...\r\n-----> Heroku receiving push\r\n-----> Fetching custom git buildpack... done\r\n-----> Wordpress app detected\r\n.\r\n[...]\r\n.\r\n-----> Discovering process types\r\n       Procfile declares types     -> (none)\r\n       Default types for Wordpress -> web\r\n-----> Compiled slug size: 33.7MB\r\n-----> Launching... done, v7\r\n```\r\n\r\nOpen your new Wordpress site in a web browser.\r\n```bash\r\n$ heroku apps:open\r\n```\r\n\r\n> Happy? Add your site to the growing [list of Wordpress sites runnning on Heroku](https://github.com/mchung/heroku-buildpack-wordpress/wiki/Sites-running-Wordpress-on-Heroku).\r\n\r\n## Overview\r\n\r\nThe buildpack bootstraps a Wordpress site using the [mchung/wordpress-on-heroku](http://github.com/mchung/wordpress-on-heroku) project template.  That repo contains everything required to run your own Wordpress site on Heroku.\r\n\r\nThere are several files available in `config` for configuring your new Wordpress site.\r\n\r\n```\r\n└── config                # Your config files goes here.\r\n    ├── public            # The public directory\r\n    │   └── wp-content    # Wordpress themes and plugins\r\n    │       ├── plugins\r\n    │       └── themes\r\n    └── vendor            # Config files for vendored apps\r\n        ├── nginx\r\n        │   └── conf      # nginx.conf + your site.conf\r\n        └── php\r\n            └── etc       # php.ini & php-fpm.conf\r\n```\r\n\r\nWhen you deploy Wordpress to Heroku, everything in `config` is copied over to Heroku.  You can configure your blog by making changes to these files.\r\n\r\nA few Wordpress environment variables can be controlled via Heroku using `heroku config:set`:\r\n\r\n* `FORCE_SSL_LOGIN`\r\n* `FORCE_SSL_ADMIN`\r\n* `WP_CACHE`\r\n* `DISABLE_WP_CRON`\r\n\r\n> To add a Heroku environment variable: `heroku config:set GOOG_UA_ID=UA=1234777-9`\r\n\r\nSee `wp-config.php` and documentation from Wordpress for details.\r\n\r\nEnabling and configuring the following Wordpress plugins will also speed up Wordpress on Heroku significantly.\r\n\r\n* `heroku-sendgrid` - Configures phpmailer to send SMTP email with Sendgrid.\r\n* `heroku-google-analytics` - Configures Google Analytics to display on your Wordpress site.\r\n  * GOOG_UA_ID=UA-9999999\r\n* `wpro` - Configures Wordpress to upload everything to S3.\r\n* `batcache` - Configures Wordpress to use memcached for caching.\r\n* `memcachier` - Use a modern memcached plugin.\r\n* `cloudflare` - OPTIONAL, but very awesome.\r\n * If Cloudflare is installed, the plugin configures Wordpress to play nicely with CloudFlare.  It sets the correct IP addresses from visitors and comments, and also protects Wordpress from spammers.\r\n * Keep in mind that the free version doesn't support SSL, so you'll need to set both `FORCE_SSL_ADMIN` and `FORCE_SSL_LOGIN` to false in order to login.\r\n\r\n## Usage\r\n\r\n### Creating your Wordpress site on Heroku\r\n```bash\r\n$ git clone git://github.com/username/wordpress-on-heroku.git myblog\r\n$ cd myblog\r\n$ heroku create -s cedar\r\n$ heroku config:add BUILDPACK_URL=https://github.com/mchung/heroku-buildpack-wordpress.git\r\n$ git push heroku master\r\n```\r\n\r\n### Adding a custom domain name\r\n```bash\r\n$ heroku domains:add marcchung.org\r\n$ heroku domains:add www.marcchung.org\r\n```\r\n\r\nNote: Adding a domain still requires some DNS setup work. Basically you'll want to do something like this:\r\n```bash\r\nALIAS marcchung.org -> proxy.herokuapp.com\r\nCNAME www.marcchung.org -> proxy.herokuapp.com\r\n```\r\n> [I use DNSimple and you should too](https://dnsimple.com/r/d2bc9a934910c1).\r\n\r\n### Adding a theme\r\n```bash\r\n$ cp -r appply config/public/wp-content/themes/\r\n$ git add .\r\n$ git commit -m \"New theme\"\r\n$ git push heroku master\r\n```\r\n\r\n### Adding a plugin\r\n```bash\r\n$ cp -r google-analytics config/public/wp-content/plugins/\r\n$ git add .\r\n$ git commit -m \"New plugin\"\r\n$ git push heroku master\r\n```\r\n> Plugins and themes must be activated via the Plugins panel.\r\n\r\n### Adding custom secret keys to wp-config.php\r\n\r\nUse the [Wordpress.org secret-key service](https://api.wordpress.org/secret-key/1.1/salt/) to override the default ones in `wp-config.php`.\r\n\r\n### Configuring cron\r\nBy default, wp-cron is fired on every page load and scheduled to run jobs like future posts or backups.  This buildpack disables wp-cron so that visitors don't have to wait to see the site.\r\n\r\nHeroku allows you to trigger wp-cron from their scheduler.\r\n```bash\r\n$ heroku addons:add scheduler:standard\r\n\r\n# Visit the Heroku scheduler dashboard and add a new task:\r\n./cron.sh\r\n```\r\n\r\nAlternatively, you may also re-enable wp-cron.\r\n```bash\r\n$ heroku config:set DISABLE_WP_CRON=false\r\n```\r\n\r\n### Enable system access\r\nThe alternative PHP cache and a generic PHPINFO page is available at /apc.php and /phpinfo.php.\r\n```bash\r\n$ heroku config:set ENABLE_SYSTEM_DEBUG=true\r\n$ heroku config:set SYSTEM_USERNAME=admin\r\n$ heroku config:set SYSTEM_PASSWORD=secret123\r\n# Visit /apc.php or /phpinfo.php\r\n```\r\n\r\n### Remove the PHP-FPM status page `/status.html`\r\nDelete the directive from `nginx.conf.erb`.\r\n\r\n### Add a `favicon.ico` drop one into `public`\r\nSee [#22](https://github.com/mchung/heroku-buildpack-wordpress/issues/22) for details.\r\n\r\n\r\n### Choosing specific versions of vendored packages\r\n\r\nSee [VERSIONS](VERSIONS.md) for how to pick specific versions of Nginx, PHP, and Wordpress\r\n\r\n### Workflow (optional)\r\n\r\nBy keeping your changes separate, it'll be easier to pull in changes from the Wordpress site template.\r\n\r\nAssign a remote `upstream`\r\n```bash\r\n$ git remote add upstream https://github.com/your_name/wordpress-on-heroku.git\r\n```\r\n\r\nTrack changes in a separate branch called `production`.\r\n```bash\r\n$ git checkout -B production\r\n$ git push heroku production:master\r\n# This keeps upstream (my) changes separate from (your) blog changes.\r\n```\r\n\r\nPull changes from upstream into `master`.\r\n```bash\r\n$ git co master\r\n$ git pull\r\n$ git co production\r\n$ git merge master\r\n```\r\n\r\nPull changes from upstream into `production`.\r\n```bash\r\n$ git pull --rebase upstream master\r\n```\r\n\r\n## How fast is this?\r\n\r\nPretty freaking fast.\r\n\r\nSystem setup\r\n* Single Heroku dyno\r\n* Default Wordpress installation\r\n* Default twentytwelve theme\r\n* Caching turned up\r\n* Cron disabled\r\n* Memcachier + ClearDB\r\n\r\nHere are some benchmarks from Google PageSpeed, Blitz.io, and Web Page Test.\r\n\r\n### Google PageSpeed\r\n\r\nResults from PageSpeed Insights: 94/100\r\n\r\n[See the PageSpeed report](https://developers.google.com/speed/pagespeed/insights#url=wordpress-on-heroku.herokuapp.com&mobile=false)\r\n\r\n### blitz.io\r\n\r\nResults from a blitz.io rush\r\n\r\n![Blitz.io rush](https://s3.amazonaws.com/heroku-buildpack-wordpress/woh-blitz-details.png)\r\n\r\nOver 200 page views per second with less than 100ms response time sustained for a minute.\r\n\r\n[See the Blitz.io report](https://www.blitz.io/report/541eb908b4ef3eec8d9c2ce2293a85ca)\r\n\r\n### Web Page Performance Test\r\n\r\n![Results from WebPageTest](https://s3.amazonaws.com/heroku-buildpack-wordpress/woh-webpagetest-details.png)\r\n\r\n[See the WebPageTest report](http://www.webpagetest.org/result/130201_BB_624/)\r\n\r\nThese tests are periodically rerun on [Wordpress on Heroku](http://wordpress-on-heroku.herokuapp.com).\r\n\r\n## But doesn't Heroku only run Ruby applications?\r\n\r\nNot anymore. Heroku's latest offerings (See [Celadon Cedar stack](http://devcenter.heroku.com/articles/cedar)) makes it easy (well, easyish) for developers to install and run any language, or service.\r\n\r\n## Constraints with Heroku\r\n\r\nThe [ephemeral filesystem](http://devcenter.heroku.com/articles/dyno-isolation)\r\n\r\n* End-users cannot upload media assets to Heroku. WORKAROUND: Enable `wpro` and use that plugin to upload media assets to S3 instead.\r\n* End-users cannot update themes or plugins from the admin page. WORKAROUND: Add them to `config/public/wp-content/themes` or `config/public/wp-content/plugins` then push to Heroku.\r\n\r\n## Security disclosure\r\n\r\nEach time Wordpress is deployed, Heroku will fetch the latest buildpack from GitHub and execute the instructions in `compile` and `deploy`.  This buildpack will download the latest precompiled versions of Nginx, PHP, and Wordpress from my personal [S3 bucket](http://heroku-buildpack-wordpress.s3.amazonaws.com) then add in config files from the [`config`](https://github.com/mchung/wordpress-on-heroku/tree/master/config) directory.\r\n\r\n## Hacking and Contributing\r\n\r\nNot comfortable downloading and running a copy of someone else's PHP or Nginx executables? Not a problem!  The `support` directory also contains a handful of compilation and deployment scripts to automate several processes, which are currently used for maintenance and repo management.\r\n\r\n* `package_nginx` - Used to compile and upload the latest version of Nginx to S3.\r\n* `package_php` - Used to compile and upload the latest version of PHP to S3.\r\n* `wordup` - Really useful helper script for creating and destroying Wordpress sites.\r\n\r\n## TODO\r\n\r\n* End-users shouldn't be able to do things that aren't supported on Heroku. Write plugins to hide everything.\r\n* Integrate New Relic.\r\n* CDN support.\r\n* Combine CSS/JS files\r\n\r\n## Authors and Contributors\r\n\r\n* Marc Chung - Follow [@mchung](https://github.com/mchung) on GitHub and also [@heisenthought](https://twitter.com/heisenthought) on Twitter\r\n\r\n## Thanks\r\n\r\nThanks for reading this all the way through.\r\n\r\nIf you use this buildpack in production, please update the [list of Wordpress sites running on Heroku](https://github.com/mchung/heroku-buildpack-wordpress/wiki/Sites-running-Wordpress-on-Heroku).\r\n\r\n## License\r\n\r\nThe MIT License - Copyright (c) 2013 Marc Chung\r\n\r\n<link href='http://haikuist.com/assets/embed.css' media='screen' rel='stylesheet' type='text/css'>\r\n<div class='haikuist_snippet' id='haiku-1922'>\r\n<div class='poem'>\r\n<div class='line1'>\r\ntake my code with you\r\n</div>\r\n<div class='line2'>\r\nand do whatever you want\r\n</div>\r\n<div class='line3'>\r\nbut please don't blame me\r\n</div>\r\n<div class='author'>\r\n&mdash;\r\nAaron Swartz\r\n</div>\r\n</div>\r\n<div class='meta'>\r\n<a href=\"http://haikuist.com/haiku/1922\">This Haiku</a>\r\nbrought to you by\r\n<a href=\"http://haikuist.com/\">Haikuist</a>\r\n</div>\r\n</div>\r\n","google":"UA-31205985-1","note":"Don't delete this file! It's used internally to help with page regeneration."}